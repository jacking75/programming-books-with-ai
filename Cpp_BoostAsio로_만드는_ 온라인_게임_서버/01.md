# C++ Boost.Asio로 만드는 온라인 게임 서버
저자: 최흥배, Claude AI   
    
권장 개발 환경
- **IDE**: Visual Studio 2022 (Community 이상)
- **컴파일러**: MSVC v143 (C++20 지원)
- **OS**: Windows 10 이상
  
-----   

# Chapter 1. 게임 서버 개발 환경 구축
게임 서버 개발을 시작하기 전에 안정적이고 효율적인 개발 환경을 구축하는 것은 매우 중요하다. 이 장에서는 C++ Boost.Asio를 사용한 게임 서버 개발에 필요한 모든 환경 설정을 단계별로 안내하겠다.

## 1.1 개발 환경 준비

### 1.1.1 시스템 요구사항
게임 서버 개발을 위한 최소 시스템 요구사항은 다음과 같다:

**하드웨어 요구사항:**
- CPU: Intel Core i5 이상 또는 AMD Ryzen 5 이상
- RAM: 8GB 이상 (16GB 권장)
- 저장공간: SSD 256GB 이상 (개발 도구 및 라이브러리 설치용)
- 네트워크: 유선 인터넷 연결 (라이브러리 다운로드 및 테스트용)

**소프트웨어 요구사항:**
- 운영체제: Windows 10/11 (64-bit)
- Visual Studio 2022 Community 이상
- Git for Windows
  
### 1.1.2 C++ 표준과 컴파일러 지원
현대적인 게임 서버 개발을 위해 다음 C++ 표준을 지원하는 환경을 구축한다:

- **C++17**: 기본 지원 (std::string_view, std::optional 등)
- **C++20**: 코루틴, 컨셉트 등 고급 기능 활용
- **C++23**: 최신 네트워킹 기능 (향후 확장성)

```cpp
// 지원하는 C++ 기능 예시
#include <string_view>
#include <optional>
#include <coroutine>  // C++20
#include <format>     // C++20

int main() 
{
    std::string_view message = "Hello Game Server";
    std::optional<int> port = 8080;
    return 0;
}
```

### 1.1.3 개발 도구 체크리스트
효율적인 개발을 위해 다음 도구들을 준비한다:

- [ ] Visual Studio 2022 (C++ 워크로드 포함)
- [ ] Git for Windows
- [ ] Windows Terminal (선택사항)
- [ ] Boost 라이브러리
- [ ] CMake (선택사항)
- [ ] vcpkg (패키지 관리자)
  

## 1.2 Boost 라이브러리 설치와 설정

### 1.2.1 Boost 라이브러리 소개
Boost는 C++ 표준 라이브러리의 확장으로, 고품질의 검증된 라이브러리 컬렉션이다. 특히 Boost.Asio는 네트워크 및 비동기 프로그래밍을 위한 강력한 도구이다.  
  
**Boost.Asio의 주요 장점:**
- **멀티플랫폼 지원**: Windows, Linux, macOS에서 동일한 코드 실행
- **고성능**: 각 플랫폼의 최적화된 I/O 메커니즘 활용 (Windows IOCP, Linux epoll)
- **신뢰성**: 수많은 프로덕션 환경에서 검증된 안정성
- **표준화**: C++ 네트워킹 TS의 기반이 되는 라이브러리

### 1.2.2 vcpkg를 이용한 Boost 설치 (권장 방법)
vcpkg는 Microsoft에서 개발한 C++ 패키지 관리자로, Boost 설치를 간편하게 해준다.

**1단계: vcpkg 설치**

```cmd
# 적절한 폴더로 이동 (예: C:\dev)
cd C:\dev
git clone https://github.com/Microsoft/vcpkg.git
cd vcpkg
.\bootstrap-vcpkg.bat
```

**2단계: Visual Studio 통합**

```cmd
.\vcpkg integrate install
```

**3단계: Boost 설치**

```cmd
# x64 Windows용 Boost 설치
.\vcpkg install boost:x64-windows

# 특정 컴포넌트만 설치하는 경우
.\vcpkg install boost-asio:x64-windows
.\vcpkg install boost-system:x64-windows
.\vcpkg install boost-thread:x64-windows
```  
위는 동적 라이브러리 설치이므로 정적 라이브러리로 설치하려면 아래처럼 해야한다.  
```
.\vcpkg install boost:x64-windows-static
```  
  
### 1.2.3 수동 Boost 빌드 (고급 사용자용)
특별한 설정이 필요한 경우 수동으로 Boost를 빌드할 수 있습니다.

**1단계: Boost 소스 다운로드**

Boost 공식 웹사이트(https://www.boost.org/)에서 최신 버전을 다운로드한다.

**2단계: 빌드 준비**

```cmd
# Boost 폴더로 이동
cd C:\boost_1_82_0

# Bootstrap 실행
bootstrap.bat
```

**3단계: 빌드 실행**

```cmd
# Release 버전 빌드
b2 --build-type=complete --abbreviate-paths architecture=x86 address-model=64 install --prefix="C:\boost" -j%NUMBER_OF_PROCESSORS%
```

**4단계: 환경 변수 설정**

시스템 환경 변수에 다음을 추가한다:
- `BOOST_ROOT`: C:\boost
- `PATH`에 C:\boost\lib 추가

### 1.2.4 설치 확인
Boost가 올바르게 설치되었는지 확인하는 간단한 테스트 프로그램을 작성해본다.

```cpp
#include <iostream>
#include <boost/version.hpp>
#include <boost/asio.hpp>

int main() 
{
    std::cout << "Boost version: " << BOOST_LIB_VERSION << std::endl;
    
    // Asio 기본 테스트
    boost::asio::io_context io_context;
    std::cout << "Boost.Asio successfully imported!" << std::endl;
    
    return 0;
}
```
  

## 1.3 Visual Studio 2022 설정

### 1.3.1 프로젝트 설정 템플릿
게임 서버 개발을 위한 표준 프로젝트 설정을 만들어보겠다.

**새 프로젝트 생성:**

1. Visual Studio 2022 실행
2. "새 프로젝트 만들기" 선택
3. "콘솔 앱" (C++) 선택
4. 프로젝트 이름: "GameServer"

**프로젝트 속성 설정:**

```
구성: 모든 구성
플랫폼: x64

C/C++ → 일반
- 추가 포함 디렉터리: $(BOOST_ROOT)\include (또는 vcpkg 경로)
- C++ 언어 표준: ISO C++20 표준 (/std:c++20)

C/C++ → 전처리기
- 전처리기 정의: 
  WIN32_LEAN_AND_MEAN
  _WIN32_WINNT=0x0A00
  BOOST_ASIO_HAS_STD_COROUTINE

링커 → 일반
- 추가 라이브러리 디렉터리: $(BOOST_ROOT)\lib (또는 vcpkg 자동 설정)

링커 → 입력
- 추가 종속성:
  ws2_32.lib
  mswsock.lib
  (vcpkg 사용 시 자동 링크)
```

### 1.3.2 디버깅 및 개발 도구 설정
효율적인 디버깅을 위한 Visual Studio 설정을 구성한다.

**디버거 설정:**

```
디버그 → Windows → 출력
- 출력 표시: 일반

도구 → 옵션 → 디버깅 → 일반
- [ ] 내 코드만 사용(관리 전용)
- [x] 소스 서버 지원 사용
- [x] 편집하며 계속하기 사용
```

**코드 분석 도구:**

```
분석 → 코드 분석 구성
- Microsoft 기본 규칙 세트 활성화
- 빌드 시 코드 분석 실행
```

  
## 1.4 첫 번째 테스트 프로젝트
환경 설정이 완료되었는지 확인하는 간단한 테스트 서버를 만들어본다.  

**main.cpp:**

```cpp
#include "pch.h"

using namespace boost::asio;
using ip::tcp;

class SimpleServer 
{
private:
    io_context& io_context_;
    tcp::acceptor acceptor_;
    
public:
    SimpleServer(io_context& io_context, unsigned short port)
        : io_context_(io_context)
        , acceptor_(io_context, tcp::endpoint(tcp::v4(), port))
    {
        std::cout << std::format("Server started on port {}\n", port);
        start_accept();
    }
    
private:
    void start_accept() 
    {
        auto new_session = std::make_shared<tcp::socket>(io_context_);
        
        acceptor_.async_accept(*new_session,
            [this, new_session](std::error_code ec) {
                if (!ec) {
                    std::cout << "Client connected!\n";
                    
                    // Echo 메시지 전송
                    auto message = std::make_shared<std::string>("Welcome to Game Server!\n");
                    async_write(*new_session, buffer(*message),
                        [new_session, message](std::error_code ec, std::size_t) {
                            if (!ec) {
                                std::cout << "Welcome message sent!\n";
                            }
                        });
                }
                start_accept();
            });
    }
};

int main() 
{
    try 
    {
        std::cout << "=== Game Server Environment Test ===\n";
        std::cout << std::format("Boost version: {}\n", BOOST_LIB_VERSION);
        
        io_context io_context;
        SimpleServer server(io_context, 8080);
        
        std::cout << "Press Ctrl+C to stop the server\n";
        io_context.run();
        
    } 
    catch (std::exception& e) {
        std::cerr << std::format("Exception: {}\n", e.what());
    }
    
    return 0;
}
```

**빌드 및 실행:**  
1. Ctrl+Shift+B로 프로젝트 빌드
2. F5로 디버그 모드 실행
3. telnet localhost 8080으로 연결 테스트


## 1.5 문제 해결 가이드

**일반적인 설치 문제와 해결책:**

**문제 1: Boost 헤더를 찾을 수 없음**
```
해결책:
1. 프로젝트 속성 → C/C++ → 일반 → 추가 포함 디렉터리 확인
2. vcpkg integrate install 재실행
3. 환경 변수 BOOST_ROOT 설정 확인
```

**문제 2: 링크 오류 (LNK2019)**
```
해결책:
1. 라이브러리 경로 확인: 추가 라이브러리 디렉터리
2. 필요한 .lib 파일 추가: ws2_32.lib, mswsock.lib
3. 플랫폼 설정 확인: x64 vs x86
```

**문제 3: C++20 기능을 사용할 수 없음**
```
해결책:
1. 프로젝트 속성 → C/C++ → 언어 → C++ 언어 표준을 ISO C++20으로 설정
2. Visual Studio 2022 최신 버전 업데이트
3. Windows SDK 최신 버전 설치
```


 
  
